–ù–∞ –æ—Å–Ω–æ–≤–µ –æ–ø–∏—Å–∞–Ω–∏—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã ‚Ññ19 –≤—ã–ø–æ–ª–Ω–∏–º –∑–∞–¥–∞–Ω–∏—è –ø–æ –ø–æ–∏—Å–∫—É, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–µ, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –°–µ–∞–Ω—Å–æ–≤ –≤ –ø—Ä–æ–µ–∫—Ç–µ ASP.NET Core (Razor Pages).

---

üìå 5.1 –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é —Ñ–∏–ª—å–º–∞

5.1.1 –î–æ–±–∞–≤–ª—è–µ–º —Å–≤–æ–π—Å—Ç–≤–æ FilmTitle –≤ –∫–ª–∞—Å—Å —Å—Ç—Ä–∞–Ω–∏—Ü—ã

–í —Ñ–∞–π–ª–µ Pages/Seansy/Index.cshtml.cs:

```csharp
public class IndexModel : PageModel
{
    private readonly ApplicationDbContext _context;

    public IndexModel(ApplicationDbContext context)
    {
        _context = context;
    }

    public IList<Seans> SeansList { get; set; }

    [BindProperty(SupportsGet = true)]
    public string FilmTitle { get; set; }

    [BindProperty(SupportsGet = true)]
    public string SortColumn { get; set; }

    [BindProperty(SupportsGet = true)]
    public int? Hall { get; set; }

    [BindProperty(SupportsGet = true)]
    public int PageIndex { get; set; } = 1;

    public int TotalPages { get; set; }
    public int PageSize { get; set; } = 10;

    // ...
}
```

---

5.1.2 –î–æ–±–∞–≤–ª—è–µ–º —Ñ–æ—Ä–º—É –ø–æ–∏—Å–∫–∞ –≤ Index.cshtml

```html
<!-- –§–æ—Ä–º–∞ –ø–æ–∏—Å–∫–∞ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ -->
<form method="get" class="row g-3 mb-4">
    <div class="col-md-4">
        <label class="form-label">–ü–æ–∏—Å–∫ –ø–æ —Ñ–∏–ª—å–º—É</label>
        <input type="text"
               name="filmTitle"
               value="@Model.FilmTitle"
               placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ..."
               onchange="this.form.submit()"
               class="form-control" />
    </div>
    <!-- –î—Ä—É–≥–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Ñ–æ—Ä–º—ã –±—É–¥—É—Ç –Ω–∏–∂–µ -->
</form>
```

---

5.1.3 –†–µ–∞–ª–∏–∑—É–µ–º –ø–æ–∏—Å–∫ –≤ OnGetAsync()

```csharp
public async Task OnGetAsync()
{
    IQueryable<Seans> seansQuery = _context.Seans
        .Include(s => s.Hall)
        .Include(s => s.Hall.Cinema);

    // –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é —Ñ–∏–ª—å–º–∞
    if (!string.IsNullOrEmpty(FilmTitle))
    {
        seansQuery = seansQuery.Where(s => s.FilmName.Contains(FilmTitle));
    }

    // –î–∞–ª—å—à–µ –±—É–¥–µ—Ç —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è, –ø–∞–≥–∏–Ω–∞—Ü–∏—è...

    SeansList = await seansQuery.ToListAsync();
}
```

---

üìå 5.2 –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞

5.2.1 –°–≤–æ–π—Å—Ç–≤–æ SortColumn —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ (—Å–º. –≤—ã—à–µ)

5.2.2 –î–æ–±–∞–≤–ª—è–µ–º –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –≤ —Ñ–æ—Ä–º—É:

```html
<div class="col-md-3">
    <label class="form-label">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞</label>
    <select class="form-control"
            name="sortColumn"
            onchange="this.form.submit()">
        <option value="">–ë–µ–∑ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏</option>
        <option value="price" selected="@(Model.SortColumn == "price")">–ü–æ —Ü–µ–Ω–µ (–¥–µ—à–µ–≤—ã–µ)</option>
        <option value="price_desc" selected="@(Model.SortColumn == "price_desc")">–ü–æ —Ü–µ–Ω–µ (–¥–æ—Ä–æ–≥–∏–µ)</option>
        <option value="date" selected="@(Model.SortColumn == "date")">–ü–æ –¥–∞—Ç–µ (—Å–Ω–∞—á–∞–ª–∞ —Å—Ç–∞—Ä—ã–µ)</option>
        <option value="date_desc" selected="@(Model.SortColumn == "date_desc")">–ü–æ –¥–∞—Ç–µ (—Å–Ω–∞—á–∞–ª–∞ –Ω–æ–≤—ã–µ)</option>
    </select>
</div>
```

---

5.2.3 –†–µ–∞–ª–∏–∑—É–µ–º —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É –≤ OnGetAsync():

```csharp
// –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
switch (SortColumn)
{
    case "price":
        seansQuery = seansQuery.OrderBy(s => s.Price);
        break;
    case "price_desc":
        seansQuery = seansQuery.OrderByDescending(s => s.Price);
        break;
    case "date":
        seansQuery = seansQuery.OrderBy(s => s.StartTime);
        break;
    case "date_desc":
        seansQuery = seansQuery.OrderByDescending(s => s.StartTime);
        break;
    default:
        seansQuery = seansQuery.OrderBy(s => s.Id);
        break;
}
```

---

üìå 5.3 –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∑–∞–ª—É

5.3.1 –°–≤–æ–π—Å—Ç–≤–æ Hall —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ (—Å–º. –≤—ã—à–µ)

5.3.2 –í OnGetAsync() –ø–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –∑–∞–ª–æ–≤:

```csharp
public async Task OnGetAsync()
{
    // –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –∑–∞–ª–æ–≤ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
    ViewData["Halls"] = new SelectList(_context.Halls
        .Select(h => new { h.Id, Info = $"{h.Cinema.Name} - –ó–∞–ª {h.Number}" }),
        "Id", "Info");

    // ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥
}
```

---

5.3.3 –î–æ–±–∞–≤–ª—è–µ–º –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ –≤ —Ñ–æ—Ä–º—É:

```html
<div class="col-md-3">
    <label class="form-label">–§–∏–ª—å—Ç—Ä –ø–æ –∑–∞–ª—É</label>
    <select class="form-control"
            asp-items="ViewBag.Halls"
            name="hall"
            onchange="this.form.submit()">
        <option value="">–í—Å–µ –∑–∞–ª—ã</option>
    </select>
</div>
```

---

5.3.4 –†–µ–∞–ª–∏–∑—É–µ–º —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é:

```csharp
// –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∑–∞–ª—É
if (Hall.HasValue && Hall.Value > 0)
{
    seansQuery = seansQuery.Where(s => s.HallId == Hall.Value);
}
```

---

üìå 5.4 –ü–∞–≥–∏–Ω–∞—Ü–∏—è

5.4.1 –°–≤–æ–π—Å—Ç–≤–∞ PageIndex –∏ TotalPages —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã

5.4.2 –†–µ–∞–ª–∏–∑—É–µ–º –ø–∞–≥–∏–Ω–∞—Ü–∏—é –≤ OnGetAsync():

```csharp
// –ü–∞–≥–∏–Ω–∞—Ü–∏—è
var totalCount = await seansQuery.CountAsync();
TotalPages = (int)Math.Ceiling(totalCount / (double)PageSize);

seansQuery = seansQuery
    .Skip((PageIndex - 1) * PageSize)
    .Take(PageSize);

SeansList = await seansQuery.ToListAsync();
```

---

5.4.3 –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –≤ Index.cshtml:

```html
<!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
<nav aria-label="–ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º">
    <ul class="pagination justify-content-center mt-4">
        @if (Model.PageIndex > 1)
        {
            <li class="page-item">
                <a class="page-link" 
                   asp-page="./Index"
                   asp-route-pageIndex="@(Model.PageIndex - 1)"
                   asp-route-filmTitle="@Model.FilmTitle"
                   asp-route-sortColumn="@Model.SortColumn"
                   asp-route-hall="@Model.Hall">
                    –ù–∞–∑–∞–¥
                </a>
            </li>
        }
        
        <li class="page-item active">
            <span class="page-link">–°—Ç—Ä–∞–Ω–∏—Ü–∞ @Model.PageIndex –∏–∑ @Model.TotalPages</span>
        </li>

        @if (Model.PageIndex < Model.TotalPages)
        {
            <li class="page-item">
                <a class="page-link" 
                   asp-page="./Index"
                   asp-route-pageIndex="@(Model.PageIndex + 1)"
                   asp-route-filmTitle="@Model.FilmTitle"
                   asp-route-sortColumn="@Model.SortColumn"
                   asp-route-hall="@Model.Hall">
                    –í–ø–µ—Ä–µ–¥
                </a>
            </li>
        }
    </ul>
</nav>
```

---

‚úÖ 6. –ü–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã

1. –í—ã–ø–æ–ª–Ω–∏—Ç—å –≤—Å–µ –∑–∞–¥–∞–Ω–∏—è –∏–∑ –ø.5 (–∫–∞–∫ –æ–ø–∏—Å–∞–Ω–æ –≤—ã—à–µ).
2. –û—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã.

---

‚ùì 8. –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã (–∫—Ä–∞—Ç–∫–∏–µ –æ—Ç–≤–µ—Ç—ã)

8.1 ‚Äî SupportsGet = true –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–∏–≤—è–∑—ã–≤–∞—Ç—å —Å–≤–æ–π—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏ –∏–∑ GET-–∑–∞–ø—Ä–æ—Å–æ–≤ (–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ URL).

8.2 ‚Äî –ü–æ—Ä—è–¥–æ–∫ –æ–ø–µ—Ä–∞—Ü–∏–π –≤ OnGetAsync():

1. –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ë–î
2. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
3. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
4. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
5. –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ ViewData/ViewBag
6. –í–æ–∑–≤—Ä–∞—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

8.3 ‚Äî ViewBag ‚Äî –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ, ViewData ‚Äî —Å–ª–æ–≤–∞—Ä—å. ViewBag –æ–±—ë—Ä—Ç—ã–≤–∞–µ—Ç ViewData.

8.4 ‚Äî onchange="this.form.submit()" –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏
